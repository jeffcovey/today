#!/bin/sh
# VS Code tunnel helper script
# Downloads and uses standalone VS Code CLI for tunnel functionality

# Check if standalone code CLI exists
if [ ! -f /workspaces/notion-cli/.vscode-cli/code ]; then
    echo "Downloading VS Code CLI for tunnel support..."
    mkdir -p /workspaces/notion-cli/.vscode-cli
    curl -Lk 'https://code.visualstudio.com/sha/download?build=stable&os=cli-alpine-x64' --output /tmp/vscode_cli.tar.gz
    tar -xf /tmp/vscode_cli.tar.gz -C /workspaces/notion-cli/.vscode-cli
    rm /tmp/vscode_cli.tar.gz
fi

cd /workspaces/notion-cli
exec /workspaces/notion-cli/.vscode-cli/code tunnel "$@"